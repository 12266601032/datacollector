<ul class="record-list" ng-init="isOpen=false">
  <li class="record-list-item">

    <div>

      <label class="pull-left"
             ng-class="{'label label-danger': record.header.errorMessage && isRoot}">

        <span class="pointer toggler {{(isOpen || (isRoot && record.expand)) ? 'open' : ''}}"
            ng-click="onClick($event)"
            ng-if="recordValue.type === 'MAP' || recordValue.type === 'LIST'"></span>

        <input ng-if="selectable === true && !isRoot" type="checkbox" ng-model="selectedPath[recordValue.path]">

        <span class="field-name" ng-class="{'dirty ': recordValue.dirty || (record.dirty && isRoot)}" ng-bind-html="fieldName"></span> :

        <span class="glyphicon glyphicon-asterisk dirty-icon" ng-if="record.dirty && isRoot"></span>
      </label>

      <div ng-switch="recordValue.type">

        <div ng-switch-when="MAP">
          <span class="field-type"> Map  </span>

          <record-tree
            ng-if="isOpen || (isRoot && record.expand)"
            ng-repeat="(_fieldName, _recordValue) in recordValue.value"
            record="record"
            record-value="_recordValue"
            field-name="_fieldName"
            is-root="false"
            editable="editable"
            selectable="selectable"
            selected-path="selectedPath">
          </record-tree>


        </div>

        <div ng-switch-when="LIST">
          <span class="field-type"> List [ {{recordValue.value.length}} ]</span>

          <record-tree
            ng-if="isOpen || (isRoot && record.expand)"
            ng-repeat="(_fieldName, _recordValue) in recordValue.value"
            record="record"
            record-value="_recordValue"
            field-name="_fieldName"
            is-root="false"
            editable="editable"
            selectable="selectable"
            selected-path="selectedPath">
          </record-tree>

        </div>

        <div ng-switch-when="DATE" class="clearfix">
          <span class="field-value pull-left"
                ng-class="recordValue.type">{{recordValue.value + '' | date:'medium'}} </span>

          <div class="dropdown pull-left"
               ng-if="editable === true"
               ng-init="dateRecordValue = recordValue.value">
            <a class="record-date-toggle dropdown-toggle" role="button" data-toggle="dropdown" data-target="#" href="">
              <i class="fa fa-calendar"></i>
            </a>
            <ul class="dropdown-menu pull-right" role="menu" aria-labelledby="dLabel">
              <datetimepicker data-ng-model="dateRecordValue"
                              data-on-set-time="recordDateValueUpdated(record, recordValue, dateRecordValue)"
                              data-datetimepicker-config="{ dropdownSelector: '.record-date-toggle' }"></datetimepicker>
            </ul>
          </div>
        </div>

        <div ng-switch-default>
          <span ng-if="editable !== true"
                class="field-value"
                ng-class="recordValue.type">{{recordValue.value + ''}}</span>
          <span class="field-value"
                ng-if="editable === true"
                ng-class="recordValue.dirty ? 'dirty ' + recordValue.type : recordValue.type"
                contenteditable="true"
                ng-change="recordValueUpdated(record, recordValue)"
                ng-model="recordValue.value">
          </span>
        </div>

      </div>
    </div>

  </li>
</ul>


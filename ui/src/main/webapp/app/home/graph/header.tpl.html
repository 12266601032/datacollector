
  <div class="pull-left" ng-switch="activeConfigStatus.state">
    <button type="button" class="navbar-toggle collapsed"
            ng-class="{'selected' : !hideLibraryPanel}"
            ng-click="toggleLibraryPanel()">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>


    <div class="panel-title pull-left"
         ng-switch-when="RUNNING">
      <h3 class="pull-left" translate="home.header.uptime">Uptime</h3>
      <h3 class="pull-left" am-time-ago="common.pipelineStatus.lastStatusChange"></h3>

      <i class="fa fa-spinner fa-spin fa-2x green-color"></i>
    </div>


    <div class="panel-title pull-left"
         ng-switch-when="STOPPING">
      <h3 class="pull-left" translate="home.header.stoppingPipeline">Stopping Pipeline</h3>
      <i class="fa fa-spinner fa-spin fa-2x red-color"></i>
    </div>

    <div class="panel-title pull-left"
         ng-switch-default>
      <h3 class="pull-left" translate="home.header.definePipeline">Define Pipeline:</h3>
      <h3 class="pull-left">{{pipelineConfig.info.name}}</h3>
    </div>


  </div>

  <div class="btn-group pull-right issues-dropdown" ng-show="pipelineConfig.issues.issueCount > 0">
    <button class="btn btn-danger btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
      <span class="fa fa-exclamation-triangle"></span>
      Issues <span class="badge alert-danger" ng-bind="pipelineConfig.issues.issueCount"></span>
    </button>
    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">

      <li role="presentation" class="dropdown-header"
          translate="home.header.pipelineIssues"
          ng-repeat-start="issue in pipelineConfig.issues.pipelineIssues">
        Pipeline Issues
      </li>
      <li role="presentation">
        <a role="menuitem" tabindex="-1" href="#"
           ng-click="onIssueClick(issue)">{{issue.message}}</a>
      </li>
      <li ng-repeat-end role="presentation" class="divider" ng-if="!$last"></li>

      <li role="presentation" class="dropdown-header"
          ng-repeat-start="(instanceName, issues) in pipelineConfig.issues.stageIssues"
          ng-bind="getStageInstanceLabel(instanceName)">
      </li>
      <li role="presentation" ng-repeat="issue in issues">
        <a role="menuitem" tabindex="-1" href="#"
           ng-click="onIssueClick(issue, instanceName)"
           ng-bind="getIssuesMessage(instanceName, issue)"></a>
      </li>
      <li ng-repeat-end role="presentation" class="divider" ng-if="!$last"></li>

    </ul>
  </div>

  <div class="pull-right" ng-if="activeConfigStatus.state !== 'STOPPING'">
    <button type="button" class="btn btn-primary btn-sm"
            ng-show="previewMode"
            ng-click="previewPipeline(true)">
      <span translate="home.header.refreshPreview">Refresh Preview</span>
      <span class="glyphicon glyphicon-refresh"></span>
    </button>


    <button type="button" class="btn btn-primary btn-sm"
            ng-show="isPipelineRunning && !snapshotMode"
            ng-click="captureSnapshot()">
      <span class="glyphicon glyphicon-camera"></span>
      <span translate="home.header.snapshot">Snapshot</span>
    </button>

    <button type="button" class="btn btn-danger btn-sm"
            ng-show="snapshotMode"
            ng-click="closeSnapshot()">
      <span class="glyphicon glyphicon-camera"></span>
      <span translate="home.header.closeSnapshot">Close Snapshot</span>
    </button>


    <button type="button" class="btn btn-primary btn-sm"
            ng-hide="isPipelineRunning || previewMode"
            ng-click="previewPipeline()"
            ng-disabled="!pipelineConfig.previewable">
      <span class="glyphicon glyphicon-eye-open"></span>
      <span translate="home.header.preview">Preview</span>
    </button>

    <button type="button" class="btn btn-danger btn-sm"
            ng-show="previewMode"
            ng-click="closePreview()">
      <span class="glyphicon glyphicon-eye-close"></span>
      <span translate="home.header.closePreview">Close Preview</span>
    </button>

    <button type="button" class="btn btn-primary btn-sm"
            ng-click="startPipeline()"
            ng-hide="isPipelineRunning || previewMode"
            ng-disabled="!pipelineConfig.valid">
      <span class="glyphicon glyphicon-play"></span>
      <span translate="home.header.start">Start</span>
    </button>

    <button type="button" class="btn btn-danger btn-sm"
            ng-click="stopPipeline()"
            ng-show="isPipelineRunning && !snapshotMode">
      <span class="glyphicon glyphicon-stop"></span>
      <span translate="home.header.stop">Stop</span>
    </button>
  </div>

  <div class="btn-group pull-right stage-dropdown" ng-hide="isPipelineRunning || previewMode || activeConfigStatus.state === 'STOPPING'">
    <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
      <span class="glyphicon glyphicon-plus"></span>
      <span translate="home.header.addStage">Add Stage</span>
      <span class="caret"></span>
    </button>
    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">

      <li role="presentation" class="dropdown-header"
          translate="home.header.sources">Sources</li>
      <li role="presentation"
          ng-repeat="stageLibrary in sources" ng-class="{disabled: sourceExists}">
        <a role="menuitem" tabindex="-1" href="#"
           ng-click="sourceExists || addStageInstance(stageLibrary)">{{stageLibrary.label}}</a>
      </li>

      <li role="presentation" class="divider"></li>

      <li role="presentation" class="dropdown-header"
          translate="home.header.processors">Processors</li>
      <li role="presentation" ng-repeat="stageLibrary in processors">
        <a role="menuitem" tabindex="-1" href="#"
           ng-click="addStageInstance(stageLibrary)">{{stageLibrary.label}}</a>
      </li>

      <li role="presentation" class="divider"></li>

      <li role="presentation" class="dropdown-header"
          translate="home.header.targets">Targets</li>
      <li role="presentation" ng-repeat="stageLibrary in targets">
        <a role="menuitem" tabindex="-1" href="#"
           ng-click="addStageInstance(stageLibrary)">{{stageLibrary.label}}</a>
      </li>

    </ul>
  </div>


  <ul class="nav navbar-nav pull-right" ng-cloak>
    <li class="pipelineAgent-status" ng-hide="common.saveOperationInProgress">
      <span class="glyphicon glyphicon-ok-circle"></span>
      <span translate="global.messages.info.saveOperationInProgress"></span>
    </li>

    <li class="pipelineAgent-status" ng-show="common.saveOperationInProgress"
        translate="global.messages.info.savingConfiguration">
    </li>
  </ul>